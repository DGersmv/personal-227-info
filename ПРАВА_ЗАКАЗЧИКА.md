# üìã –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –ó–∞–∫–∞–∑—á–∏–∫–∞ - –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è

## ‚úÖ –ß—Ç–æ –º–æ–∂–µ—Ç –¥–µ–ª–∞—Ç—å –ó–∞–∫–∞–∑—á–∏–∫

### **1. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤**

–ó–∞–∫–∞–∑—á–∏–∫ –º–æ–∂–µ—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ —Ç–∏–ø—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤:

- ‚úÖ **–ü–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–µ –¥–æ–≥–æ–≤–æ—Ä—ã** - –∑–∞–≥—Ä—É–∑–∏—Ç—å –ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π –¥–æ–≥–æ–≤–æ—Ä –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
- ‚úÖ **–ê–∫—Ç—ã –ø—Ä–∏–µ–º–∞-—Å–¥–∞—á–∏ —Ä–∞–±–æ—Ç** - –∑–∞–≥—Ä—É–∑–∏—Ç—å –∞–∫—Ç—ã –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —ç—Ç–∞–ø–æ–≤
- ‚úÖ **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏—è** - –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫ –¥–æ–≥–æ–≤–æ—Ä—É
- ‚úÖ **–°–ø—Ä–∞–≤–∫–∏ –∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã** - –¥–æ–∫—É–º–µ–Ω—Ç—ã –æ—Ç —Ç—Ä–µ—Ç—å–∏—Ö –ª–∏—Ü
- ‚úÖ **–î—Ä—É–≥–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã** - –ª—é–±—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –ø—Ä–æ–µ–∫—Ç–æ–º

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
- –ú–æ–∂–µ—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç—ã —Ç–æ–ª—å–∫–æ –∫ —Å–≤–æ–∏–º –æ–±—ä–µ–∫—Ç–∞–º
- –ú–æ–∂–µ—Ç —É–¥–∞–ª—è—Ç—å —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
- –ù–µ –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç—ã, –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤—â–∏–∫–æ–º –∏–ª–∏ –°—Ç—Ä–æ–∏—Ç–µ–ª–µ–º

### **2. –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ**

–ó–∞–∫–∞–∑—á–∏–∫ –º–æ–∂–µ—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å —Ñ–æ—Ç–æ:

- ‚úÖ **–§–æ—Ç–æ –æ–±—ä–µ–∫—Ç–∞ –¥–æ –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç** - –¥–ª—è —Ñ–∏–∫—Å–∞—Ü–∏–∏ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- ‚úÖ **–§–æ—Ç–æ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Ä–∞–±–æ—Ç** - –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –∫–∞—á–µ—Å—Ç–≤–∞
- ‚úÖ **–§–æ—Ç–æ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è** - –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- ‚úÖ **–§–æ—Ç–æ –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö –º–µ—Å—Ç** - –¥–ª—è –æ–±—Å—É–∂–¥–µ–Ω–∏—è —Å –ø–æ–¥—Ä—è–¥—á–∏–∫–∞–º–∏

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
- –ú–æ–∂–µ—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å —Ñ–æ—Ç–æ —Ç–æ–ª—å–∫–æ –∫ —Å–≤–æ–∏–º –æ–±—ä–µ–∫—Ç–∞–º
- –ú–æ–∂–µ—Ç —É–¥–∞–ª—è—Ç—å —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Ñ–æ—Ç–æ
- –ù–µ –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å —Ñ–æ—Ç–æ, –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –°—Ç—Ä–æ–∏—Ç–µ–ª–µ–º

### **3. –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∏ —Ñ–æ—Ç–æ**

- ‚úÖ –ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –≤—Å–µ –≤–∏–¥–∏–º—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –∏ —Ñ–æ—Ç–æ
- ‚úÖ –°–∫–∞—á–∏–≤–∞—Ç—å –æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
- ‚úÖ –ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é –∑–∞–≥—Ä—É–∑–æ–∫

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏

### **–í API Routes –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å:**

1. **–ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ñ–∞–π–ª–∞:**
   ```typescript
   // –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ –æ–±—ä–µ–∫—Ç –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
   const object = await prisma.object.findFirst({
     where: { id: objectId, userId: currentUser.id }
   });
   
   if (!object) {
     return Response.json({ error: '–û–±—ä–µ–∫—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω' }, { status: 404 });
   }
   ```

2. **–ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞:**
   ```typescript
   // –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ —Ñ–∞–π–ª –∑–∞–≥—Ä—É–∂–µ–Ω —Ç–µ–∫—É—â–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
   const document = await prisma.document.findFirst({
     where: { 
       id: documentId,
       // –ù—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ uploadedByUserId –≤ –º–æ–¥–µ–ª—å Document
       uploadedByUserId: currentUser.id 
     }
   });
   
   if (!document) {
     return Response.json({ error: '–î–æ–∫—É–º–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω –∏–ª–∏ –Ω–µ—Ç –ø—Ä–∞–≤' }, { status: 403 });
   }
   ```

3. **–ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞:**
   ```typescript
   // –ê–Ω–∞–ª–æ–≥–∏—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∫ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏
   ```

## üìù –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### **1. –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ –≤ –º–æ–¥–µ–ª—å Document:**

```prisma
model Document {
  // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è
  uploadedByUserId Int?  // ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–≥—Ä—É–∑–∏–ª –¥–æ–∫—É–º–µ–Ω—Ç
  uploadedByUser   User? @relation("UploadedDocuments", fields: [uploadedByUserId], references: [id])
  
  // ...
}
```

### **2. –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ –≤ –º–æ–¥–µ–ª—å Photo:**

```prisma
model Photo {
  // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è
  uploadedByUserId Int?  // ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–≥—Ä—É–∑–∏–ª —Ñ–æ—Ç–æ
  uploadedByUser   User? @relation("UploadedPhotos", fields: [uploadedByUserId], references: [id])
  
  // ...
}
```

### **3. –í API routes –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É:**

```typescript
// –ü—Ä–∏–º–µ—Ä –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞
export async function POST(request: Request) {
  const user = await getCurrentUser(request);
  
  // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤
  if (!canUser(user, 'document', 'create')) {
    return Response.json({ error: '–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤' }, { status: 403 });
  }
  
  // –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ –æ–±—ä–µ–∫—Ç –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
  const { objectId } = await request.json();
  const object = await prisma.object.findFirst({
    where: { id: objectId, userId: user.id }
  });
  
  if (!object) {
    return Response.json({ error: '–û–±—ä–µ–∫—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω' }, { status: 404 });
  }
  
  // –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞...
  // –ü—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –≤ –ë–î —É–∫–∞–∑–∞—Ç—å uploadedByUserId: user.id
}
```

## ‚úÖ –ò—Ç–æ–≥–æ–≤—ã–µ –ø—Ä–∞–≤–∞ –ó–∞–∫–∞–∑—á–∏–∫–∞

| –†–µ—Å—É—Ä—Å | –°–æ–∑–¥–∞—Ç—å | –ß–∏—Ç–∞—Ç—å | –û–±–Ω–æ–≤–∏—Ç—å | –£–¥–∞–ª–∏—Ç—å |
|--------|---------|--------|----------|---------|
| –ü—Ä–æ–µ–∫—Ç—ã | ‚ùå | ‚úÖ | ‚ùå | ‚ùå |
| –û–±—ä–µ–∫—Ç—ã | ‚ùå | ‚úÖ (—Å–≤–æ–∏) | ‚ùå | ‚ùå |
| –î–æ–∫—É–º–µ–Ω—Ç—ã | ‚úÖ (—Å–≤–æ–∏) | ‚úÖ | ‚úÖ (—Å–≤–æ–∏) | ‚úÖ (—Å–≤–æ–∏) |
| –§–æ—Ç–æ | ‚úÖ (—Å–≤–æ–∏) | ‚úÖ | ‚ùå | ‚úÖ (—Å–≤–æ–∏) |
| –ü–∞–Ω–æ—Ä–∞–º—ã | ‚ùå | ‚úÖ | ‚ùå | ‚ùå |
| –°–æ–æ–±—â–µ–Ω–∏—è | ‚úÖ | ‚úÖ | ‚ùå | ‚ùå |
| –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ | ‚úÖ | ‚úÖ | ‚ùå | ‚ùå |
| –ü–ª–∞—Ç–µ–∂–∏ | ‚úÖ | ‚úÖ | ‚ùå | ‚ùå |

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** "–°–≤–æ–∏" –æ–∑–Ω–∞—á–∞–µ—Ç —Ñ–∞–π–ª—ã, –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Å–∞–º–∏–º –ó–∞–∫–∞–∑—á–∏–∫–æ–º.

---

**–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** 2025-01-27



