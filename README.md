# Personal227Info - –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞–º–∏

–ü—Ä–æ–µ–∫—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã–º–∏ –ø—Ä–æ–µ–∫—Ç–∞–º–∏ —Å —Å–∏—Å—Ç–µ–º–æ–π —Ä–æ–ª–µ–π –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π —Å insales.ru

## üé≠ –°–∏—Å—Ç–µ–º–∞ —Ä–æ–ª–µ–π

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–∏—Å—Ç–µ–º—É –∏–∑ 4 —Ä–æ–ª–µ–π:

- **DESIGNER** (–ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤—â–∏–∫) - —Å–æ–∑–¥–∞–µ—Ç –∏ —É–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–æ–µ–∫—Ç–∞–º–∏
- **BUILDER** (–°—Ç—Ä–æ–∏—Ç–µ–ª—å) - –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Ñ–æ—Ç–æ –∏ –ø–∞–Ω–æ—Ä–∞–º—ã —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–∞
- **CUSTOMER** (–ó–∞–∫–∞–∑—á–∏–∫) - –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç –ø—Ä–æ–µ–∫—Ç—ã –∏ –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç —É—Å–ª—É–≥–∏
- **ADMIN** (–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä) - –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º —Ñ—É–Ω–∫—Ü–∏—è–º

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
npm install
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ PostgreSQL
2. –°–æ–∑–¥–∞–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö:
```sql
CREATE DATABASE personal227info;
```

3. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –Ω–∞ –æ—Å–Ω–æ–≤–µ `.env.example`:
```env
DATABASE_URL="postgresql://user:password@localhost:5432/personal227info?schema=public"
JWT_SECRET="your-secret-key"

# Insales OAuth –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ!)
INSALES_API_KEY="your-api-key"
INSALES_API_SECRET="your-api-secret"
INSALES_SHOP_DOMAIN="myshop.insales.ru"
INSALES_OAUTH_REDIRECT_URI="http://localhost:3000/api/auth/insales/callback"
```

**‚ö†Ô∏è –í–∞–∂–Ω–æ:** –î–ª—è —Ä–∞–±–æ—Ç—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å insales. –°–º. [INSALES_SETUP.md](./INSALES_SETUP.md)

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Prisma

```bash
# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Prisma Client (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π!)
npm run db:generate

# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Å—Ö–µ–º—ã –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
npm run db:push

# –ò–ª–∏ —Å–æ–∑–¥–∞–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏ (–¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞)
npm run db:migrate
```

**‚ö†Ô∏è –í–∞–∂–Ω–æ:** –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è `prisma/schema.prisma` –≤—Å–µ–≥–¥–∞ –∑–∞–ø—É—Å–∫–∞–π—Ç–µ `npm run db:generate`

### 4. –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

```bash
# –†–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
npm run dev

# –°–±–æ—Ä–∫–∞ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
npm run build
npm start
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
personal227info/
‚îú‚îÄ‚îÄ prisma/
‚îÇ   ‚îî‚îÄ‚îÄ schema.prisma          # –°—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ lib/
‚îÇ   ‚îú‚îÄ‚îÄ prisma.ts              # Prisma –∫–ª–∏–µ–Ω—Ç
‚îÇ   ‚îî‚îÄ‚îÄ roles.ts               # –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ä–æ–ª—è–º–∏
‚îú‚îÄ‚îÄ middleware/
‚îÇ   ‚îî‚îÄ‚îÄ roleCheck.ts           # Middleware –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–æ–ª–µ–π
‚îú‚îÄ‚îÄ types/
‚îÇ   ‚îî‚îÄ‚îÄ roles.ts                # TypeScript —Ç–∏–ø—ã –¥–ª—è —Ä–æ–ª–µ–π
‚îî‚îÄ‚îÄ app/                        # Next.js App Router
```

## üîê –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã —Ä–æ–ª–µ–π

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–∏ –≤ API Route

```typescript
import { checkRoleMiddleware } from '@/middleware/roleCheck';
import { ROLES } from '@/types/roles';

export async function POST(request: Request) {
  // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–∏
  const roleCheck = await checkRoleMiddleware(request, {
    role: ROLES.DESIGNER
  });
  
  if (roleCheck) {
    return roleCheck; // –í–µ—Ä–Ω–µ—Ç –æ—à–∏–±–∫—É 403
  }
  
  // –ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏...
}
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞

```typescript
import { canUser } from '@/lib/roles';

// –ü—Ä–æ–≤–µ—Ä–∫–∞, –º–æ–∂–µ—Ç –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞—Ç—å –ø—Ä–æ–µ–∫—Ç
if (canUser(user, 'project', 'create')) {
  // –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
}
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö

```typescript
import { hasRole, isDesigner } from '@/lib/roles';

function ProjectForm({ user }) {
  if (!isDesigner(user)) {
    return <div>–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞</div>;
  }
  
  return <form>...</form>;
}
```

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –û—Å–Ω–æ–≤–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã:
- [–ü–ª–∞–Ω —Ä–∞–±–æ—Ç—ã](./–ü–õ–ê–ù_–†–ê–ë–û–¢–´.md) - –¥–µ—Ç–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- [–°–∏—Å—Ç–µ–º–∞ —Ä–æ–ª–µ–π](./–°–ò–°–¢–ï–ú–ê_–†–û–õ–ï–ô.md) - –æ–ø–∏—Å–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã —Ä–æ–ª–µ–π
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–∞–π—Ç–∞](./–°–¢–†–£–ö–¢–£–†–ê_–°–ê–ô–¢–ê.md) - —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–∞–∑–¥–µ–ª–æ–≤ –ø–æ —Ä–æ–ª—è–º
- [–ê–Ω–∞–ª–∏–∑ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏](./–ê–ù–ê–õ–ò–ó_–ò_–†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò.md) - –≤—ã–±–æ—Ä —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π
- [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ insales](./INSALES_SETUP.md) - –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ OAuth –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ insales

### –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞:
- [–ü—Ä–∞–≤–∞ –ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤—â–∏–∫–∞](./–ü–†–ê–í–ê_–ü–†–û–ï–ö–¢–ò–†–û–í–©–ò–ö–ê.md) - –¥–µ—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞ –ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤—â–∏–∫–∞
- [–ü—Ä–∞–≤–∞ –°—Ç—Ä–æ–∏—Ç–µ–ª—è](./–ü–†–ê–í–ê_–°–¢–†–û–ò–¢–ï–õ–Ø.md) - –¥–µ—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞ –°—Ç—Ä–æ–∏—Ç–µ–ª—è
- [–ü—Ä–∞–≤–∞ –ó–∞–∫–∞–∑—á–∏–∫–∞](./–ü–†–ê–í–ê_–ó–ê–ö–ê–ó–ß–ò–ö–ê.md) - –¥–µ—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞ –ó–∞–∫–∞–∑—á–∏–∫–∞
- [–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–∞–≤](./–°–†–ê–í–ù–ï–ù–ò–ï_–ü–†–ê–í.md) - —Å—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞

## üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Next.js 15** - React —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ (App Router)
- **TypeScript 5.5** - —Ç–∏–ø–∏–∑–∞—Ü–∏—è
- **Prisma 6.17** - ORM –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ë–î
- **PostgreSQL** - –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **Tailwind CSS 3.4** - —Å—Ç–∏–ª–∏–∑–∞—Ü–∏—è
- **JWT** - –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (jsonwebtoken)
- **BCrypt** - —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π

## üìù TODO

- [x] –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞
- [x] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Prisma —Å PostgreSQL
- [x] –°–æ–∑–¥–∞—Ç—å —Å—Ö–µ–º—É –ë–î —Å —Ä–æ–ª—è–º–∏
- [x] –°–æ–∑–¥–∞—Ç—å —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ä–æ–ª—è–º–∏
- [x] –°–æ–∑–¥–∞—Ç—å middleware –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–æ–ª–µ–π
- [x] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –±–∞–∑–æ–≤—É—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é (JWT)
- [x] –°–æ–∑–¥–∞—Ç—å API routes –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (login, register, logout, me)
- [x] –°–æ–∑–¥–∞—Ç—å –±–∞–∑–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (Header, InsalesLoginButton)
- [x] –°–æ–∑–¥–∞—Ç—å –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏ –¥–∞—à–±–æ—Ä–¥
- [x] –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –æ–±—ä–µ–∫—Ç–æ–≤
- [x] –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é —á–µ—Ä–µ–∑ insales OAuth
- [x] –°–æ–∑–¥–∞—Ç—å –º–æ–¥–µ–ª—å InSalesAccount –≤ –ë–î
- [ ] –°–æ–∑–¥–∞—Ç—å –ø–æ–ª–Ω—ã–π –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç –¥–ª—è –∫–∞–∂–¥–æ–π —Ä–æ–ª–∏
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞–º–∏ (CRUD)
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞–º–∏
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∑–∞–≥—Ä—É–∑–∫—É –∏ –ø—Ä–æ—Å–º–æ—Ç—Ä —Ñ–æ—Ç–æ/–ø–∞–Ω–æ—Ä–∞–º
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º—É —Å–æ–æ–±—â–µ–Ω–∏–π
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å insales.ru

## ‚ö†Ô∏è –í–∞–∂–Ω–æ

- **–ù–ï –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ SQLite –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞!** –¢–æ–ª—å–∫–æ PostgreSQL
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ connection pooling –¥–ª—è Prisma
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è —Å–µ–∫—Ä–µ—Ç–æ–≤
- –ù–µ –∫–æ–º–º–∏—Ç—å—Ç–µ `.env` —Ñ–∞–π–ª—ã

